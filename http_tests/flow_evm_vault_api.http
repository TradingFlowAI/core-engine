### Flow EVM Vault API Tests

# 基础配置
@host = http://localhost:7001
@auth_token = your_auth_token_here
@chain_id = 545
@factory_address = 0x1234567890abcdef1234567890abcdef12345678
@investor_address = 0x1111111111111111111111111111111111111111
@vault_address = 0x2222222222222222222222222222222222222222
@token_address = 0x3333333333333333333333333333333333333333

### 1. 创建新的Flow EVM Vault
POST {{host}}/flow/vaults/create
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "investor_address": "{{investor_address}}",
  "swap_router": "0x4444444444444444444444444444444444444444",
  "wrapped_native": "0x5555555555555555555555555555555555555555",
  "factory_address": "{{factory_address}}",
  "chain_id": {{chain_id}}
}

### 2. 获取Vault信息
GET {{host}}/flow/vaults/{{chain_id}}/{{vault_address}}
Authorization: Bearer {{auth_token}}

### 3. 根据投资者地址获取Vault
GET {{host}}/flow/vaults/investor/{{chain_id}}/{{investor_address}}?factory_address={{factory_address}}
Authorization: Bearer {{auth_token}}

### 4. 获取投资组合构成
GET {{host}}/flow/vaults/{{chain_id}}/{{vault_address}}/portfolio
Authorization: Bearer {{auth_token}}

### 5. 执行交易信号
POST {{host}}/flow/vaults/trade-signal
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "chain_id": {{chain_id}},
  "vault_address": "{{vault_address}}",
  "token_in": "0x6666666666666666666666666666666666666666",
  "token_out": "0x7777777777777777777777777777777777777777",
  "amount_in": "1000000000000000000",
  "amount_out_min": "900000000000000000",
  "fee_recipient": "0x8888888888888888888888888888888888888888",
  "fee_rate": 100
}

### 6. 获取代币信息
GET {{host}}/flow/vaults/tokens/{{chain_id}}/{{token_address}}
Authorization: Bearer {{auth_token}}

### 7. 获取代币余额
GET {{host}}/flow/vaults/tokens/{{chain_id}}/{{token_address}}/balance/{{investor_address}}
Authorization: Bearer {{auth_token}}

### 8. 错误测试 - 无效的链ID
GET {{host}}/flow/vaults/invalid_chain_id/{{vault_address}}
Authorization: Bearer {{auth_token}}

### 9. 错误测试 - 缺少必需参数
POST {{host}}/flow/vaults/create
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "investor_address": "{{investor_address}}"
}

### 10. 错误测试 - 缺少factory_address参数
GET {{host}}/flow/vaults/investor/{{chain_id}}/{{investor_address}}
Authorization: Bearer {{auth_token}}
