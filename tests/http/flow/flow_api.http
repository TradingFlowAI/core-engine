### Flow API 测试
@baseUrl = http://localhost:7002
@flowId = 685c29b6f58fed2b58428874
@cycle = 1
@binanceNodeId = binance_price_node_1
@aiModelNodeId = ai_model_node_1
@complexFlowId = complex_test_flow

### 1. 执行 Flow
# @name execute_flow
POST {{baseUrl}}/flows/execute
Content-Type: application/json

{
  "flow_id": "{{flowId}}",
  "cycle_interval": "0",
  "flow_json": {
    "nodes": [
      {
        "id": "{{binanceNodeId}}",
        "type": "binance_price_node",
        "config": {
          "node_class_type": "binance_price_node",
          "symbol": "BTCUSDT",
          "interval": "1m"
        }
      },
      {
        "id": "{{aiModelNodeId}}",
        "type": "ai_model_node",
        "config": {
          "node_class_type": "ai_model_node",
          "model": "gpt-4",
          "prompt": "请根据BTC/USDT的行情数据，分析当前市场趋势，并给出买入、卖出或观望的建议。"
        }
      }
    ],
    "edges": [
      {
        "source": "{{binanceNodeId}}",
        "source_handle": "current_price",
        "target": "{{aiModelNodeId}}",
        "target_handle": "model"
      }
    ]
  }
}

### 2. 获取 Flow 状态
# @name get_flow_status
GET {{baseUrl}}/flows/{{flowId}}/status
Content-Type: application/json

### 3. 停止 Flow 执行
# @name stop_flow
POST {{baseUrl}}/flows/{{flowId}}/stop
Content-Type: application/json

### 4. 执行 Flow 的特定 Cycle
# @name execute_flow_cycle
POST {{baseUrl}}/flows/685c29b6f58fed2b58428874/cycles/execute
Content-Type: application/json

{
  "cycle": {{cycle}}
}

### 5. 获取 Flow Cycle 状态
# @name get_flow_cycle_status
GET {{baseUrl}}/flows/{{flowId}}/cycles/{{cycle}}/status
Content-Type: application/json

### 6. 停止 Flow 的特定组件
# @name stop_component
POST {{baseUrl}}/flows/{{flowId}}/cycles/{{cycle}}/components/{{aiModelNodeId}}/stop
Content-Type: application/json

### 7. 获取 Flow 执行日志列表
# @name get_flow_execution_logs
GET {{baseUrl}}/flows/{{flowId}}/logs
Content-Type: application/json

### 8. 获取 Flow 执行日志列表（带过滤条件）
# @name get_flow_execution_logs_filtered
GET {{baseUrl}}/flows/{{flowId}}/logs?cycle={{cycle}}&node_id={{binanceNodeId}}&log_level=INFO&limit=10&offset=0&order_by=created_at&order_direction=desc
Content-Type: application/json

### 9. 获取特定日志详情
# @name get_flow_execution_log_detail
GET {{baseUrl}}/flows/logs/1
Content-Type: application/json

### 10. 获取特定 Flow、Cycle 和 Node 的日志
# @name get_flow_cycle_node_logs
GET {{baseUrl}}/flows/{{flowId}}/cycles/{{cycle}}/nodes/{{binanceNodeId}}/logs
Content-Type: application/json

### 11. 获取特定 Flow、Cycle 的系统日志
# @name get_flow_cycle_system_logs
GET {{baseUrl}}/flows/{{flowId}}/cycles/{{cycle}}/nodes/system/logs
Content-Type: application/json

### 12. 获取特定 Flow、Cycle 和 Node 的日志（带过滤条件）
# @name get_flow_cycle_node_logs_filtered
GET {{baseUrl}}/flows/{{flowId}}/cycles/{{cycle}}/nodes/{{aiModelNodeId}}/logs?log_level=ERROR&log_source=node&limit=20&offset=0&order_by=created_at&order_direction=asc
Content-Type: application/json

### 13. 测试复杂 Flow 执行
# @name execute_complex_flow
POST {{baseUrl}}/flows/execute
Content-Type: application/json

{
  "flow_id": "{{complexFlowId}}",
  "cycle_interval": "60",
  "flow_json": {
    "nodes": [
      {
        "id": "binance_price_node_btc",
        "type": "binance_price_node",
        "config": {
          "node_class_type": "binance_price_node",
          "symbol": "BTCUSDT",
          "interval": "1m"
        }
      },
      {
        "id": "binance_price_node_eth",
        "type": "binance_price_node",
        "config": {
          "node_class_type": "binance_price_node",
          "symbol": "ETHUSDT",
          "interval": "1m"
        }
      },
      {
        "id": "data_processor_node",
        "type": "data_processor_node",
        "config": {
          "node_class_type": "data_processor_node",
          "processing_type": "correlation"
        }
      },
      {
        "id": "ai_model_node",
        "type": "ai_model_node",
        "config": {
          "node_class_type": "ai_model_node",
          "model": "gpt-4",
          "prompt": "分析BTC和ETH的价格相关性，并给出交易建议。"
        }
      },
      {
        "id": "notification_node",
        "type": "notification_node",
        "config": {
          "node_class_type": "notification_node",
          "notification_type": "email",
          "recipient": "user@example.com"
        }
      }
    ]
  }
}

### 14. 执行 Flow 的多个 Cycle
# @name execute_multiple_cycles
POST {{baseUrl}}/flows/685c29b6f58fed2b58428874/cycles/execute
Content-Type: application/json

{
  "cycle": {{cycle}},
  "count": 3
}
